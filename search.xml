<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>bsgs</title>
    <url>/2019/12/26/bsgs-exbsgs/</url>
    <content><![CDATA[<h3 id="BSGS"><a href="#BSGS" class="headerlink" title="BSGS"></a>BSGS</h3><p>求$a^x\equiv b\space( \mod p)$ 的解，保证$p$为质数。</p>
<p>我们设$x=i<em>m-j$，其中$0\leq j &lt;m$。那么原式可转化为$a^{im}\equiv b</em>a^j(\mod p)$的解。我们预处理出$b<em>a^0,b</em>a^1,…,b*a^{m-1}$的值，将它们存入$hash$表中，枚举$i$的值，每次查看$a^{im}$在表中是否出现。</p>
<p>由费马小定理可知，等号左边是有循环节$p-1$的，所以只需要从$1$到$\frac{p}{m}$枚举$i$ ，则不包含哈希表的时间复杂度在当$m=\lceil\sqrt{n}\rceil$时最优，为$O(\sqrt{p})$，在实际中常使用std::map作为哈希表，时间复杂度为$O(\sqrt p\log_2p)$</p>
]]></content>
      <tags>
        <tag>数论</tag>
      </tags>
  </entry>
  <entry>
    <title>多项式与生成函数</title>
    <url>/2019/12/22/%E5%A4%9A%E9%A1%B9%E5%BC%8F/</url>
    <content><![CDATA[<h4 id="分治FFT"><a href="#分治FFT" class="headerlink" title="分治FFT"></a>分治FFT</h4><p>给定数组$g[1],…,g[n-1]$，求$f[0],…,f[n-1]$，其中</p>
<script type="math/tex; mode=display">
f[i]=\sum\limits_{j=1}^i{f[i-j]g[j]}\\f[0]=1</script><p>在模$998244353$意义下进行</p>
<p>考虑分治，先计算左半边，再计算左对右贡献，最后计算右半边，复杂度$O(Nlog^2N)$ </p>
<p>也可以求逆解决，设</p>
<script type="math/tex; mode=display">
F(x)=\sum\limits_{i=0}^{n-1}f[i]x^i\\G(x)=\sum\limits_{i=0}^{n-1}g[i]x^i</script><p>其中，$g[0]=0$</p>
<p>对其卷积（在$\mod x^n$意义下进行）</p>
<script type="math/tex; mode=display">
F(x)G(x)\sum\limits_{k=0}^{n-1}\sum\limits_{i+j=k}f[i]g[j]x^k\\
F(x)G(x)=\sum\limits_{k=0}^{n-1}f[k]x^k-f[0]\\
F(x)G(x)=F(x)-f[0]\\
F(x)(G(x)-1)=-f[0]\\
F(x)=\frac{f[0]}{1-G(x)}</script><p>（第二行是因为$g[0]=0$,所以$f[0]g[0]=0$）由于$f[0]=1$，求逆就好了，复杂度$O(NlogN)$</p>
<h4 id="多项式-ln"><a href="#多项式-ln" class="headerlink" title="多项式 $\ln$"></a>多项式 $\ln$</h4><p>求$B(x)$使得</p>
<script type="math/tex; mode=display">
B(x)\equiv \ln A(x) \mod p</script><p>设</p>
<script type="math/tex; mode=display">
G(x)=\ln(x)</script><script type="math/tex; mode=display">
B(x)\equiv G(A(x))\mod p</script><p>两边同时求导得</p>
<script type="math/tex; mode=display">
B'(x)\equiv G'(A(x))A'(x)\mod p</script><script type="math/tex; mode=display">
B'(x)\equiv \frac{A'(x)}{A(x)}\mod p</script><script type="math/tex; mode=display">
B(x) \equiv \int \frac{A'(x)}{A(x)}dx\mod p</script><p>多项式求导，求逆，积分即可</p>
<p>注：</p>
<script type="math/tex; mode=display">
A'(x)=\sum\limits_{i=1}^{n-1}ia_ix^{i-1}</script><script type="math/tex; mode=display">
\int A(x)=\sum\limits_{i=0}^{n-1}\frac{a_{i}}{i+1}x^{i+1}dx</script><h4 id="ZJOI2014-力"><a href="#ZJOI2014-力" class="headerlink" title="[ZJOI2014]力"></a>[ZJOI2014]力</h4><p>给出n个数$q_i$，给出$F_j$的定义如下：</p>
<script type="math/tex; mode=display">
F_j = \sum_{i<j}\frac{q_i q_j}{(i-j)^2 }-\sum_{i>j}\frac{q_i q_j}{(i-j)^2 }</script><p>令$E_i=\frac{F_i}{q_i}$，求$E_i$</p>
<script type="math/tex; mode=display">
E_j=\sum_{i<j}\frac{q_i}{(i-j)^2 }-\sum_{i>j}\frac{q_i}{(i-j)^2 }</script><p>设$f[i]=q[i],g[i]=\frac{1}{i^2}$</p>
<p>则</p>
<script type="math/tex; mode=display">
E_j=\sum\limits_{i<j}f[i]g[j-i]-\sum\limits_{i>j}f[i]g[i-j]\\
E_j=\sum\limits_{i=1}^{j-1}f[i]g[j-i]-\sum\limits_{i=j+1}^nf[i]g[i-j]</script><p>设$f’[i]=f[n-i+1]$</p>
<p>则</p>
<script type="math/tex; mode=display">
E_j=\sum\limits_{i=1}^{j-1}f[i]g[j-i]-\sum\limits_{i=1}^{n-j}f'[i]g[j-i]</script><p>直接卷积就好了</p>
]]></content>
      <tags>
        <tag>多项式</tag>
      </tags>
  </entry>
</search>
